var ED=function(){var $=!1;return this.init=function(jq){$=jq;var fs=this.fullScreen();fs.onClick("#btnFullScreen"),this.setup_tabs(),this.setup_joystick()},this.setup_tabs=function(){var tabs=this.tabs();tabs.init($)},this.setup_joystick=function(){var joy=this.joystick();joy.init($)},this},ed=new ED;ED.prototype.fullScreen=function(){var fn=this;fn.is_supported=!1,fn.is_fullscreen=!1,fn.startFullScreen=function(){},fn.exitFullScreen=function(){},(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)&&(fn.is_supported=!0);var d=document.documentElement;return d.requestFullscreen?fn.startFullScreen=function(){d.requestFullscreen()}:d.webkitRequestFullscreen?fn.startFullScreen=function(){d.webkitRequestFullscreen()}:d.mozRequestFullScreen?fn.startFullScreen=function(){d.mozRequestFullScreen()}:d.msRequestFullscreen&&(fn.startFullScreen=function(){d.msRequestFullScreen()}),document.exitFullscreen?fn.exitFullScreen=function(){document.exitFullscreen()}:document.webkitExitFullscreen?fn.exitFullScreen=function(){document.webkitExitFullscreen()}:document.mozCancelFullScreen?fn.exitFullScreen=function(){document.mozCancelFullScreen()}:document.msExitFullscreen&&(fn.exitFullScreen=function(){document.msExitFullscreen()}),fn.onClick=function(selector){fn.is_supported?$(selector).click(function(){fn.toggleFullScreen()}):$(selector).hide()},fn.toggleFullScreen=function(){fn.is_fullscreen?(fn.exitFullScreen(),fn.is_fullscreen=!1):(fn.startFullScreen(),fn.is_fullscreen=!0)},fn.init=function(){},fn};var VirtualJoystick=function(opts){opts=opts||{},this._container=opts.container||document.body,this._strokeStyle=opts.strokeStyle||"cyan",this._stickEl=opts.stickElement||this._buildJoystickStick(),this._baseEl=opts.baseElement||this._buildJoystickBase(),this._mouseSupport=void 0!==opts.mouseSupport?opts.mouseSupport:!1,this._stationaryBase=opts.stationaryBase||!1,this._baseX=this._stickX=opts.baseX||0,this._baseY=this._stickY=opts.baseY||0,this._limitStickTravel=opts.limitStickTravel||!1,this._stickRadius=void 0!==opts.stickRadius?opts.stickRadius:100,this._useCssTransform=void 0!==opts.useCssTransform?opts.useCssTransform:!1,this._container.style.position="relative",this._container.appendChild(this._baseEl),this._baseEl.style.position="absolute",this._baseEl.style.display="none",this._container.appendChild(this._stickEl),this._stickEl.style.position="absolute",this._stickEl.style.display="none",this._pressed=!1,this._touchIdx=null,this._stationaryBase===!0&&(this._baseEl.style.display="",this._baseEl.style.left=this._baseX-this._baseEl.width/2+"px",this._baseEl.style.top=this._baseY-this._baseEl.height/2+"px"),this._transform=this._useCssTransform?this._getTransformProperty():!1,this._has3d=this._check3D();var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};this._$onTouchStart=__bind(this._onTouchStart,this),this._$onTouchEnd=__bind(this._onTouchEnd,this),this._$onTouchMove=__bind(this._onTouchMove,this),this._container.addEventListener("touchstart",this._$onTouchStart,!1),this._container.addEventListener("touchend",this._$onTouchEnd,!1),this._container.addEventListener("touchmove",this._$onTouchMove,!1),this._mouseSupport&&(this._$onMouseDown=__bind(this._onMouseDown,this),this._$onMouseUp=__bind(this._onMouseUp,this),this._$onMouseMove=__bind(this._onMouseMove,this),this._container.addEventListener("mousedown",this._$onMouseDown,!1),this._container.addEventListener("mouseup",this._$onMouseUp,!1),this._container.addEventListener("mousemove",this._$onMouseMove,!1))};VirtualJoystick.prototype.destroy=function(){this._container.removeChild(this._baseEl),this._container.removeChild(this._stickEl),this._container.removeEventListener("touchstart",this._$onTouchStart,!1),this._container.removeEventListener("touchend",this._$onTouchEnd,!1),this._container.removeEventListener("touchmove",this._$onTouchMove,!1),this._mouseSupport&&(this._container.removeEventListener("mouseup",this._$onMouseUp,!1),this._container.removeEventListener("mousedown",this._$onMouseDown,!1),this._container.removeEventListener("mousemove",this._$onMouseMove,!1))},VirtualJoystick.touchScreenAvailable=function(){return"createTouch"in document?!0:!1},function(destObj){destObj.addEventListener=function(event,fct){return void 0===this._events&&(this._events={}),this._events[event]=this._events[event]||[],this._events[event].push(fct),fct},destObj.removeEventListener=function(event,fct){void 0===this._events&&(this._events={}),event in this._events!=!1&&this._events[event].splice(this._events[event].indexOf(fct),1)},destObj.dispatchEvent=function(event){if(void 0===this._events&&(this._events={}),void 0!==this._events[event]){for(var tmpArray=this._events[event].slice(),i=0;i<tmpArray.length;i++){var result=tmpArray[i].apply(this,Array.prototype.slice.call(arguments,1));if(void 0!==result)return result}return void 0}}}(VirtualJoystick.prototype),VirtualJoystick.prototype.deltaX=function(){return this._stickX-this._baseX},VirtualJoystick.prototype.deltaY=function(){return this._stickY-this._baseY},VirtualJoystick.prototype.up=function(){if(this._pressed===!1)return!1;var deltaX=this.deltaX(),deltaY=this.deltaY();return deltaY>=0?!1:Math.abs(deltaX)>2*Math.abs(deltaY)?!1:!0},VirtualJoystick.prototype.down=function(){if(this._pressed===!1)return!1;var deltaX=this.deltaX(),deltaY=this.deltaY();return 0>=deltaY?!1:Math.abs(deltaX)>2*Math.abs(deltaY)?!1:!0},VirtualJoystick.prototype.right=function(){if(this._pressed===!1)return!1;var deltaX=this.deltaX(),deltaY=this.deltaY();return 0>=deltaX?!1:Math.abs(deltaY)>2*Math.abs(deltaX)?!1:!0},VirtualJoystick.prototype.left=function(){if(this._pressed===!1)return!1;var deltaX=this.deltaX(),deltaY=this.deltaY();return deltaX>=0?!1:Math.abs(deltaY)>2*Math.abs(deltaX)?!1:!0},VirtualJoystick.prototype._onUp=function(){this._pressed=!1,this._stickEl.style.display="none",0==this._stationaryBase&&(this._baseEl.style.display="none",this._baseX=this._baseY=0,this._stickX=this._stickY=0)},VirtualJoystick.prototype._onDown=function(x,y){if(this._pressed=!0,0==this._stationaryBase&&(this._baseX=x,this._baseY=y,this._baseEl.style.display="",this._move(this._baseEl.style,this._baseX-this._baseEl.width/2,this._baseY-this._baseEl.height/2)),this._stickX=x,this._stickY=y,this._limitStickTravel===!0){var deltaX=this.deltaX(),deltaY=this.deltaY(),stickDistance=Math.sqrt(deltaX*deltaX+deltaY*deltaY);if(stickDistance>this._stickRadius){var stickNormalizedX=deltaX/stickDistance,stickNormalizedY=deltaY/stickDistance;this._stickX=stickNormalizedX*this._stickRadius+this._baseX,this._stickY=stickNormalizedY*this._stickRadius+this._baseY}}this._stickEl.style.display="",this._move(this._stickEl.style,this._stickX-this._stickEl.width/2,this._stickY-this._stickEl.height/2)},VirtualJoystick.prototype._onMove=function(x,y){if(this._pressed===!0){if(this._stickX=x,this._stickY=y,this._limitStickTravel===!0){var deltaX=this.deltaX(),deltaY=this.deltaY(),stickDistance=Math.sqrt(deltaX*deltaX+deltaY*deltaY);if(stickDistance>this._stickRadius){var stickNormalizedX=deltaX/stickDistance,stickNormalizedY=deltaY/stickDistance;this._stickX=stickNormalizedX*this._stickRadius+this._baseX,this._stickY=stickNormalizedY*this._stickRadius+this._baseY}}this._move(this._stickEl.style,this._stickX-this._stickEl.width/2,this._stickY-this._stickEl.height/2)}},VirtualJoystick.prototype._onMouseUp=function(event){return this._onUp()},VirtualJoystick.prototype._onMouseDown=function(event){event.preventDefault();var x=event.clientX,y=event.clientY;return this._onDown(x,y)},VirtualJoystick.prototype._onMouseMove=function(event){var x=event.clientX,y=event.clientY;return this._onMove(x,y)},VirtualJoystick.prototype._onTouchStart=function(event){if(null===this._touchIdx){var isValid=this.dispatchEvent("touchStartValidation",event);if(isValid!==!1){this.dispatchEvent("touchStart",event),event.preventDefault();var touch=event.changedTouches[0];this._touchIdx=touch.identifier;var x=touch.pageX,y=touch.pageY;return this._onDown(x,y)}}},VirtualJoystick.prototype._onTouchEnd=function(event){if(null!==this._touchIdx){this.dispatchEvent("touchEnd",event);for(var touchList=event.changedTouches,i=0;i<touchList.length&&touchList[i].identifier!==this._touchIdx;i++);if(i!==touchList.length)return this._touchIdx=null,event.preventDefault(),this._onUp()}},VirtualJoystick.prototype._onTouchMove=function(event){if(null!==this._touchIdx){for(var touchList=event.changedTouches,i=0;i<touchList.length&&touchList[i].identifier!==this._touchIdx;i++);if(i!==touchList.length){var touch=touchList[i];event.preventDefault();var x=touch.pageX,y=touch.pageY;return this._onMove(x,y)}}},VirtualJoystick.prototype._buildJoystickBase=function(){var canvas=document.createElement("canvas");canvas.width=126,canvas.height=126;var ctx=canvas.getContext("2d");return ctx.beginPath(),ctx.strokeStyle=this._strokeStyle,ctx.lineWidth=6,ctx.arc(canvas.width/2,canvas.width/2,40,0,2*Math.PI,!0),ctx.stroke(),ctx.beginPath(),ctx.strokeStyle=this._strokeStyle,ctx.lineWidth=2,ctx.arc(canvas.width/2,canvas.width/2,60,0,2*Math.PI,!0),ctx.stroke(),canvas},VirtualJoystick.prototype._buildJoystickStick=function(){var canvas=document.createElement("canvas");canvas.width=86,canvas.height=86;var ctx=canvas.getContext("2d");return ctx.beginPath(),ctx.strokeStyle=this._strokeStyle,ctx.lineWidth=6,ctx.arc(canvas.width/2,canvas.width/2,40,0,2*Math.PI,!0),ctx.stroke(),canvas},VirtualJoystick.prototype._move=function(style,x,y){this._transform?this._has3d?style[this._transform]="translate3d("+x+"px,"+y+"px, 0)":style[this._transform]="translate("+x+"px,"+y+"px)":(style.left=x+"px",style.top=y+"px")},VirtualJoystick.prototype._getTransformProperty=function(){for(var style,styles=["webkitTransform","MozTransform","msTransform","OTransform","transform"],el=document.createElement("p"),i=0;i<styles.length;i++)if(style=styles[i],null!=el.style[style])return style},VirtualJoystick.prototype._check3D=function(){var prop=this._getTransformProperty();if(!prop||!window.getComputedStyle)return module.exports=!1;var map={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"},el=document.createElement("div");el.style[prop]="translate3d(1px,1px,1px)",document.body.insertBefore(el,null);var val=getComputedStyle(el).getPropertyValue(map[prop]);document.body.removeChild(el);var exports=null!=val&&val.length&&"none"!=val;return exports},ED.prototype.joystick=function(){var $,joystick,fn=this;return fn.init=function(jq){$=jq,document.addEventListener("touchmove",function(e){fn.attach("#navJoystick")}),document.addEventListener("touchend",function(e){fn.destroy(),alert("x")})},fn.destroy=function(){joystick.destroy()},fn.attach=function(elementID){console.log("touchscreen is",VirtualJoystick.touchScreenAvailable()?"available":"not available"),joystick=new VirtualJoystick({container:$(elementID)[0],baseElement:$(elementID)[0],mouseSupport:!0}),joystick.addEventListener("touchStart",function(){console.log("down")}),joystick.addEventListener("touchEnd",function(){console.log("up")})},fn},ED.prototype.tabs=function(){var fn=this;return fn.init=function($){$('[data-rel="tab"]').each(function(el){$(el).click(function(e){e.preventDefault(),$(this).tab("show")})})},fn};var App=function(){var fn=this;return fn.onload=function(){},fn.onLoad=function(callback){fn.onload=callback},fn.init=function($){ed.init($)},fn.load=function(){ljs.load("bundle_js",function(){jQuery(function($){console.log(fn.onload),fn.onload($),fn.init($)})})},fn},app=new App;